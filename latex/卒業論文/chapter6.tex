\chapter{計算実験}\label{computational_result}
\section{実験環境}
実験に用いるプログラムはC++を用いて実装し、計算機はプロセッサ 1.4GHz Intel Core i5, メモリ 16GB 2133 MHz LPDDR3のmacOsを搭載したものを使用した。探索における最適なサービス開始時刻を決定する際のLPソルバーとしては、Gurobi Optimizer (ver 9.0.0)を使用した。

\section{問題例の作成方法}
DARPでは多くの既存研究があるが、本研究では時間枠及び乗車時間に対して区分線形で凸のペナルティ関数で与えている。このような問題設定のインスタンスは存在していないため、ベンチマークとしてよく使用されるCordeauらによって提供されている\cite{tabu}インスタンスに修正を加えて計算実験を行う。修正方法を以下に示す。

時間枠に関しては、サービス開始可能時刻を$e$、サービス開始最遅時間を$l$とすると、0以上$e$以下に対しては傾き-1、$e$から$l$に対しては値が0、$l$以上に対しては傾きが1となるような、区分数が3のペナルティ関数を作成する。この修正作業を全てのリクエストに対して行う。乗車時間に関しては、乗車時間の閾値を$L$とすると、0以上$L$以下に対しては値が0、$L$以上に対しては傾きが1となるような区分数2のペナルティ関数を作成する。この修正作業を全てのリクエストペアに対して行う。
\section{インスタンスについて}
計算実験に使用するインスタンスは、以下の特徴を持つ。
\begin{enumerate}
 \item 訪問点におけるサービス時間$d$を10とする。
 \item 乗降人数は1人とする。
 \item 訪問点$v_i$と$v_j$間の距離$c_{ij}$と時間$t_{ij}$は、2つの頂点のユークリッド距離とする。
 \item 乗車時間の閾値(最大乗車時間)を90とする。
 \item 車両の最大容量を6人とする。
 \item それぞれの車両のルートの最大の長さを480とする。
\end{enumerate}
以上の特徴を持つリクエスト数24から144のインスタンスを使用して計算実験を行った。
\section{実験結果}
ここでは、提案手法について行った計算実験の結果を示す。
顧客数と車両数がそれぞれ同じであるインスタンスが2つずつあるため、添字$a,b$で区別する。
\subsection{挿入近傍と交換近傍の比較}
\label{sec:insert}
局所探索におけるルート間の近傍操作として挿入近傍と交換近傍の比較を行った。
目的関数におけるペナルティ係数$\alpha,\beta$は1とする。
試行回数を$10^4$回としたときの計算結果を表\ref{insert}に示す。

ほぼ全てのインスタンスにおいて、挿入近傍による値のほうが交換近傍による値よりも良い性能であることが確認でき、平均で6.5\%良い性能であることが確認できた。

\subsection{既存研究との比較}
本研究での提案手法で、時間枠と乗車時間のペナルティの値を大きくすることで、既存研究との計算結果を比較することができる。\ref{sec:insert}で挿入近傍のほうが良い解を得られることが確認できたため、挿入近傍を用いて出力した解とCordeauらによって示された最良値を比較する。また、目的関数におけるペナルティを$\alpha=1,\beta=50$とする。
Cordeauらによって示された最良値は試行回数が$10^5$回の値であるため、同様に$10^5$回の試行を行い、結果を比較した。計算実験の値と最良解との相違を表\ref{cordeau}に示す。

\subsection{車両数を減らした計算結果}
サービスにおける


\begin{table}[]
\tabcolsep = 19pt
\renewcommand{\arraystretch}{0.8}
\caption{挿入近傍と交換近傍の比較}
\label{insert}
\begin{tabular}{ccccrcr}
\hline
    & \multicolumn{2}{c}{size} & \multicolumn{2}{c}{挿入近傍}                          & \multicolumn{2}{c}{交換近傍}                         \\ \cline{2-7}
問題例 & 顧客数           &  車両数          & 最良値                      & \multicolumn{1}{c}{計算時間} & 最良値                      & \multicolumn{1}{c}{計算時間} \\ \cline{2-7}
r1a & 24          & 3          & \multicolumn{1}{r}{216.005} & 2.14                     & \multicolumn{1}{r}{233.376} & 1.728                    \\
r2a & 48          & 5          & \multicolumn{1}{r}{514.503}  & 2.93                      & \multicolumn{1}{r}{566.30}  & 2.81                     \\
r3a & 72         & 7          & \multicolumn{1}{r}{960.476} & 4.917                     & \multicolumn{1}{r}{959.992} & 4.745                   \\
r1b & 24          & 3          & \multicolumn{1}{r}{195.6} & 2.417                     & \multicolumn{1}{r}{209.956} & 2.482                     \\
r2b & 48          & 5          & \multicolumn{1}{r}{437.568} & 3.340                     & \multicolumn{1}{r}{453.139} & 3.247                     \\
r3b & 72         & 7          & \multicolumn{1}{r}{921.741} & 4.658                   & \multicolumn{1}{r}{1031.662} & 4.719                 \\
& \multicolumn{1}{c}{} & \multicolumn{1}{l}{} &                          &                           &                         &                               \\
 \multicolumn{1}{c}{average} & \multicolumn{1}{c}{} &                          &   \multicolumn{1}{r}{540.982}                        &    \multicolumn{1}{r}{3.4}                      &  \multicolumn{1}{r}{575.738}  &     \multicolumn{1}{r}{3.288}                        \\
\hline
\end{tabular}
\end{table}



\begin{table}[]
\tabcolsep = 18pt
\renewcommand{\arraystretch}{0.8}
\caption{Best Known Scoreとの比較}
\label{cordeau}
\begin{tabular}{ccclllll}
\hline
        & \multicolumn{2}{c}{size}                    & \multicolumn{3}{c}{本研究}                                                        & \multicolumn{2}{c}{Besk Known Score}                       \\ \cline{2-8}
問題例     & n                    & m                    & \multicolumn{1}{c}{値} & \multicolumn{1}{c}{ペナルティ} & \multicolumn{1}{c}{GAP(\%)} & \multicolumn{1}{c}{1000} & \multicolumn{1}{c}{10000} \\ \cline{2-8}
r1a     & 24                   & 3                    & \multicolumn{1}{r}{212.49}    & \multicolumn{1}{r}{0.0}     & \multicolumn{1}{r}{11.8}   & \multicolumn{1}{r}{190.79}    & \multicolumn{1}{r}{190.02}     \\
r2a     & 48                   & 3                    & \multicolumn{1}{r}{386.03}    & \multicolumn{1}{r}{0.0}     & \multicolumn{1}{r}{27.7}   & \multicolumn{1}{r}{302.08}    & \multicolumn{1}{r}{302.08}     \\
r3a     & 72                   & 7                   & \multicolumn{1}{r}{763.27}    & \multicolumn{1}{r}{3.5}     & \multicolumn{1}{r}{43.4}   & \multicolumn{1}{r}{532.08}    & \multicolumn{1}{r}{532.08}     \\
r4a     & 120                   & 9                  & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{572.68}    & \multicolumn{1}{r}{572.78}     \\
r5a     & 144                  & 11                   & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{636.97}    & \multicolumn{1}{r}{636.97}     \\
r6a     & 24                   & 13                    & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{801.40}    & \multicolumn{1}{r}{801.40}     \\
r1b    & 48                  & 3                    & \multicolumn{1}{r}{195.6}    & \multicolumn{1}{r}{0.0}     & \multicolumn{1}{r}{18.9}   & \multicolumn{1}{r}{164.72}    & \multicolumn{1}{r}{164.46}     \\
r2b     & 72                  & 5                  & \multicolumn{1}{r}{388.43}    & \multicolumn{1}{r}{0.0}     & \multicolumn{1}{r}{31.0}   & \multicolumn{1}{r}{301.28}    & \multicolumn{1}{r}{296.06}     \\
r3b     & 24                   &7                   & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{498.20}    & \multicolumn{1}{r}{493.30}     \\
r4b     & 24                   & 9                   & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{548.89}    & \multicolumn{1}{r}{535.90}     \\
r5b     & 120                 & 11                   & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{592.65}    & \multicolumn{1}{r}{589.74}     \\
r6b     & 144               & 13                   & \multicolumn{1}{r}{1}    & \multicolumn{1}{r}{2}     & \multicolumn{1}{r}{3}   & \multicolumn{1}{r}{766.55}    & \multicolumn{1}{r}{743.60}     \\
        & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} &                          &                           &                         &                          &                           \\
average & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} &                          &                           &                         &       \multicolumn{1}{r}{524.91 }                    &       \multicolumn{1}{r}{515.38}                     \\ \hline
\end{tabular}
\end{table}

% \begin{table}[htbp]
%  \centering
%  \tabcolsep = 40pt
%  \renewcommand{\arraystretch}{0.8}
%  \caption{表の表示例}
%  \label{table12}
%  \begin{tabular}{lrr} \hline
%   問題例 & 挿入近傍 & 計算時間（秒)& 挿入近傍 & 計算時間（秒) \\ \hline
%   instance\_24\_3 &    123 & 10.1 \\
%   c10100 &    456 & 15.2 \\
%   c20100 &    789 & 20.3 \\ \hline
%  \end{tabular}
% \end{table}


% \begin{table*}
%  \centering
%  \tabcolsep = 19pt
%  \renewcommand{\arraystretch}{0.8}
%  \caption{2段組みスタイルにおいて幅の広い表を表示する例}
%  \label{table2}
%  \begin{tabular}{lrrcrr} \hline
%   &\multicolumn{2}{c}{既存手法} && \multicolumn{2}{c}{提案手法}\\ \cline{2-3} \cline{5-6}
%
%   問題例 & 最良値 & 計算時間（秒）&& 最良値 & 計算時間（秒） \\ \hline
%   c05100 &    123 &          10.1 &&    111 &          10.0 \\
%   c10100 &    456 &          15.2 &&    432 &          15.0 \\
%   c20100 &    789 &          20.3 &&    765 &          20.0 \\ \hline
%  \end{tabular}
% \end{table*}
